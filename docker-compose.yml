version: "3.7"

services:
  db:
    image: postgres:13.2-alpine 
    container_name: db
    #restart: always
    environment:
      POSTGRES_PASSWORD: crypto_money
      POSTGRES_DB: crypto
      POSTGRES_USER: postgres
    ports:
      - 5432:5432
    #volumes:
      #- ./postgres_data:/var/lib/postgresql/data
  app:
    build:
      context: .
      dockerfile: local.Dockerfile
    container_name: cetacoin
    #restart: always
    ports:
      - "8000:8000"
    volumes:
      - ./cetacoin:/app
    depends_on:
      - "db"
    command: sh -c "python manage.py migrate && python manage.py runserver 0.0.0.0:8000"
    environment:
      #------DB configuration
      - DB_HOST=db
      - DB_NAME=crypto
      - DB_USER=postgres
      - DB_PASSWORD=crypto_money
      #------CORS configuration
      - CORS_ORIGIN_ALL:1
      - CORS_ALLOW=1
      #- CORS_ALLOWED_HOSTS:'http://localhost:3000'      
      #------Settings configuration
      - DEBUG=1
      - ALLOWED_HOSTS=*
      #- SECRET_KEY=samplesecret123
      #-------JWT configuration
      #- JWT_SECRET_KEY:JWT_SECRET_KEY
